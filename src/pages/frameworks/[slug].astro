---
import BaseLayout from "../../layouts/BaseLayout.astro";
import SchemaArticle from "../../components/SchemaArticle.astro";
import { getCollection, getEntryBySlug } from "astro:content";

export async function getStaticPaths() {
  const items = await getCollection("frameworks");
  return items
    .filter((x) => !x.data.draft)
    .map((x) => ({ params: { slug: x.slug } }));
}

const { slug } = Astro.params;
const entry = await getEntryBySlug("frameworks", slug!);
if (!entry) throw new Error(`Framework not found: ${slug}`);

const { Content } = await entry.render();
const path = `/frameworks/${entry.slug}/`;
---

<BaseLayout
  title={`${entry.data.title} — Wychwood Partners`}
  description={entry.data.description}
  canonicalPath={path}
  ogType="article"
>
  <SchemaArticle
    headline={entry.data.title}
    description={entry.data.description}
    urlPath={path}
    datePublished={entry.data.publishDate}
    dateModified={entry.data.updatedDate}
    authorName="Wychwood Partners"
  />

  <main class="shell py-14 max-w-3xl">
    <p class="kicker">
      {entry.data.frameworkName ?? "Framework"}
    </p>
    <h1 class="mt-3">{entry.data.title}</h1>
    <p class="mt-4 text-lg text-[rgb(var(--text-muted))]">{entry.data.description}</p>

    <article class="prose mt-10 max-w-none">
      <Content />
    </article>

    <div class="mt-10">
      <a class="text-sm font-medium text-[rgb(var(--text))] hover:underline" href="/frameworks/">
        ← Back to frameworks
      </a>
    </div>
  </main>
</BaseLayout>