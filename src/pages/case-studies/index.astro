---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { getCollection } from "astro:content";

const items = (await getCollection("case-studies"))
  .filter((x) => !x.data.draft)
  .sort((a, b) => b.data.publishDate.valueOf() - a.data.publishDate.valueOf());
---

<BaseLayout
  title="Case Studies — Wychwood Partners"
  description="Structured case studies with measurable outcomes."
  canonicalPath="/case-studies/"
>
  <main class="shell py-14">
    <header class="max-w-3xl">
      <h1>Case studies</h1>
      <p class="mt-4 text-lg text-[rgb(var(--text-muted))]">
        Proof, not promises. Short, structured engagements with clear outcomes.
      </p>
    </header>

    <section class="mt-10 grid grid-cols-1 gap-6 md:grid-cols-2">
      {items.map((cs) => (
        <a href={`/case-studies/${cs.slug}/`} class="group card p-6 transition hover:shadow-md">
          <p class="kicker">
            {(cs.data.industry ?? "Case study") + (cs.data.stage ? ` • ${cs.data.stage}` : "")}
          </p>

          <h2 class="mt-2">{cs.data.title}</h2>
          <p class="mt-2 text-sm text-[rgb(var(--text-muted))]">{cs.data.description}</p>

          {cs.data.outcomes?.length ? (
            <ul class="mt-4 space-y-1 text-sm text-[rgb(var(--text-muted))]">
              {cs.data.outcomes.slice(0, 3).map((o) => (
                <li>• {o}</li>
              ))}
            </ul>
          ) : null}

          <p class="mt-5 text-sm font-medium text-[rgb(var(--text))] group-hover:underline">
            Read →
          </p>
        </a>
      ))}
    </section>

    {items.length === 0 ? (
      <div class="mt-10 card p-6">
        <p class="text-sm font-semibold">No case studies published yet</p>
        <p class="mt-2 text-sm text-[rgb(var(--text-muted))]">
          Add MDX files to <code>src/content/case-studies</code> and set <code>draft: false</code>.
        </p>
      </div>
    ) : null}
  </main>
</BaseLayout>